---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";
import { type HTMLAttributes } from "astro/types";
import cn from "@utils/cn";

import appBg from "@assets/images/bg/app-sec-bg.png";
import appBgBlur from "@assets/images/bg/app-sec-bg-blur.png";

import gallery1 from "@assets/images/gallery/1.jpg";
import gallery2 from "@assets/images/gallery/2.jpg";
import gallery3 from "@assets/images/gallery/3.jpg";
import gallery4 from "@assets/images/gallery/4.jpg";
import gallery5 from "@assets/images/gallery/5.jpg";
import gallery6 from "@assets/images/gallery/6.jpg";
import gallery7 from "@assets/images/gallery/7.jpg";
import gallery8 from "@assets/images/gallery/8.jpg";
import gallery9 from "@assets/images/gallery/9.jpg";
import gallery10 from "@assets/images/gallery/10.jpg";
import gallery11 from "@assets/images/gallery/11.jpg";
import gallery12 from "@assets/images/gallery/12.jpg";
import gallery13 from "@assets/images/gallery/13.jpg";
import gallery14 from "@assets/images/gallery/14.jpg";
import gallery15 from "@assets/images/gallery/15.jpg";
import gallery16 from "@assets/images/gallery/16.jpg";
import gallery17 from "@assets/images/gallery/17.jpg";
import gallery18 from "@assets/images/gallery/18.jpg";
import gallery19 from "@assets/images/gallery/19.jpg";
import gallery20 from "@assets/images/gallery/20.jpg";
import gallery21 from "@assets/images/gallery/21.jpg";
import gallery22 from "@assets/images/gallery/22.jpg";
import gallery23 from "@assets/images/gallery/23.jpg";
import gallery24 from "@assets/images/gallery/24.jpg";
import ButtonLink from "./Ui/ButtonLink.astro";

export interface AppLogo {
  src: ImageMetadata;
  alt: string;
  calcWidth: number;
}

const TARGET_HEIGHT_PX = 320;
const imageHeight = "h-[320px]";
function getCalculatedWidth(logo: ImageMetadata): number {
  const originalAspectRatio = logo.width / logo.height;
  const calculatedWidth = originalAspectRatio * TARGET_HEIGHT_PX;
  return calculatedWidth + 5;
}

const IMAGES: AppLogo[] = [
  {
    src: gallery1,
    alt: "Gallery Image 1",
    calcWidth: getCalculatedWidth(gallery1),
  },
  {
    src: gallery2,
    alt: "Gallery Image 2",
    calcWidth: getCalculatedWidth(gallery2),
  },
  {
    src: gallery3,
    alt: "Gallery Image 3",
    calcWidth: getCalculatedWidth(gallery3),
  },
  {
    src: gallery4,
    alt: "Gallery Image 4",
    calcWidth: getCalculatedWidth(gallery4),
  },
  {
    src: gallery5,
    alt: "Gallery Image 5",
    calcWidth: getCalculatedWidth(gallery5),
  },
  {
    src: gallery6,
    alt: "Gallery Image 6",
    calcWidth: getCalculatedWidth(gallery6),
  },
  {
    src: gallery7,
    alt: "Gallery Image 7",
    calcWidth: getCalculatedWidth(gallery7),
  },
  {
    src: gallery8,
    alt: "Gallery Image 8",
    calcWidth: getCalculatedWidth(gallery8),
  },
  {
    src: gallery9,
    alt: "Gallery Image 9",
    calcWidth: getCalculatedWidth(gallery9),
  },
  {
    src: gallery10,
    alt: "Gallery Image 10",
    calcWidth: getCalculatedWidth(gallery10),
  },
  {
    src: gallery11,
    alt: "Gallery Image 11",
    calcWidth: getCalculatedWidth(gallery11),
  },
  {
    src: gallery12,
    alt: "Gallery Image 12",
    calcWidth: getCalculatedWidth(gallery12),
  },
  {
    src: gallery13,
    alt: "Gallery Image 13",
    calcWidth: getCalculatedWidth(gallery13),
  },
  {
    src: gallery14,
    alt: "Gallery Image 14",
    calcWidth: getCalculatedWidth(gallery14),
  },
  {
    src: gallery15,
    alt: "Gallery Image 15",
    calcWidth: getCalculatedWidth(gallery15),
  },
  {
    src: gallery16,
    alt: "Gallery Image 16",
    calcWidth: getCalculatedWidth(gallery16),
  },
  {
    src: gallery17,
    alt: "Gallery Image 17",
    calcWidth: getCalculatedWidth(gallery17),
  },
  {
    src: gallery18,
    alt: "Gallery Image 18",
    calcWidth: getCalculatedWidth(gallery18),
  },
  {
    src: gallery19,
    alt: "Gallery Image 19",
    calcWidth: getCalculatedWidth(gallery19),
  },
  {
    src: gallery20,
    alt: "Gallery Image 20",
    calcWidth: getCalculatedWidth(gallery20),
  },
  {
    src: gallery21,
    alt: "Gallery Image 21",
    calcWidth: getCalculatedWidth(gallery21),
  },
  {
    src: gallery22,
    alt: "Gallery Image 22",
    calcWidth: getCalculatedWidth(gallery22),
  },
  {
    src: gallery23,
    alt: "Gallery Image 23",
    calcWidth: getCalculatedWidth(gallery23),
  },
  {
    src: gallery24,
    alt: "Gallery Image 24",
    calcWidth: getCalculatedWidth(gallery24),
  },
];

type Props = HTMLAttributes<"section">;
const { class: className, ...props } = Astro.props;
const sectionClass = cn(
  "relative overflow-hidden p-(--sectionPadding)",
  className,
);
---

<section class:list={[sectionClass]} {...props}>
  <div class="mx-auto px-4">
    <span class="cs-topper text-center">Gallery</span>
    <h2 class="cs-title text-accent-primary mb-12 text-center">
      Showcasing Our Finest Creations
    </h2>

    <!-- Logos Carousel -->
    <div
      class="scrollbar-hide mask-bg-3 relative mx-auto mb-8 flex w-full items-center justify-end"
    >
      {
        [...Array(2)].map((_, i) => (
          <div
            aria-hidden={i === 1}
            class="animate-move-to-right grid auto-cols-[1fr] grid-flow-col grid-rows-1 gap-32.5 pl-32.5"
          >
            {IMAGES.slice(0, IMAGES.length / 2).map(
              ({ src, alt, calcWidth }) => (
                <div
                  class:list={["flex items-center justify-center", imageHeight]}
                  style={`width: ${calcWidth}px;`}
                >
                  <Image src={src} alt={alt} class="size-full object-contain" />
                </div>
              ),
            )}
          </div>
        ))
      }
    </div>

    <div
      class="scrollbar-hide mask-bg-3 relative mx-auto flex w-full items-center justify-start"
    >
      {
        [...Array(2)].map((_, i) => (
          <div
            aria-hidden={i === 1}
            class="animate-move-to-left grid auto-cols-[1fr] grid-flow-col grid-rows-1 gap-32.5 pr-32.5"
          >
            {IMAGES.slice(IMAGES.length / 2).map(({ src, alt, calcWidth }) => (
              <div
                class:list={["flex items-center justify-center", imageHeight]}
                style={`width: ${calcWidth}px;`}
              >
                <Image src={src} alt={alt} class="size-full object-contain" />
              </div>
            ))}
          </div>
        ))
      }
    </div>
  </div>

  <div class="mt-6 flex items-center justify-center">
    <ButtonLink class="mx-auto" href="/portfolio">
      View Full Gallery
    </ButtonLink>
  </div>

  <!-- <Image
    src={appBg}
    class="xs:scale-200 absolute top-1/2 left-1/2 -z-1 -translate-1/2 scale-300 sm:scale-160 md:scale-130 lg:scale-90"
    alt={"blurred bg"}
  /> -->
</section>
