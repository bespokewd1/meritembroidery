---
import BaseLayout from "@layouts/BaseLayout.astro";
import client from "@data/client.json";
import Landing from "@components/Landing.astro";

// Optimize our landing image and pass it as props to the BaseLayout (for preloading) and Landing (for rendering)
import landingImage from "@assets/images/landing.jpg" // <-- THE PATH TO THE ASSET YOU WANT TO PRELOAD - The asset must live in src
import { getImage } from "astro:assets";
const optimizedImage = await getImage({src: landingImage, format: 'avif'})
---

<script is:inline>
    document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("contactForm");
    const fileInput = document.getElementById("fileInput");
    const uploadBox = document.getElementById("uploadBox");
    const fileList = document.getElementById("fileList");
    const message = document.getElementById("formMessage");

    // üîπ Click ‚Üí open file picker
    uploadBox.addEventListener("click", () => fileInput.click());

    // üîπ Drag & drop support
    uploadBox.addEventListener("dragover", (e) => {
        e.preventDefault();
        uploadBox.classList.add("dragover");
    });

    uploadBox.addEventListener("dragleave", () => {
        uploadBox.classList.remove("dragover");
    });

    uploadBox.addEventListener("drop", (e) => {
        e.preventDefault();
        uploadBox.classList.remove("dragover");
        fileInput.files = e.dataTransfer.files;
        displayFiles();
    });

    // üîπ Display file list
    fileInput.addEventListener("change", displayFiles);

    function displayFiles() {
        const files = Array.from(fileInput.files);
        fileList.innerHTML = files.length
        ? `<strong>Files Selected:</strong><ul>${files.map(f => `<li>${f.name}</li>`).join('')}</ul>`
        : "";
    }

    // üîπ Optional: handle form submission with Fetch
    form.addEventListener("submit", async (e) => {
        e.preventDefault();
        message.style.display = "block";
        message.textContent = "Sending...";

        const formData = new FormData(form);

        try {
        // ‚öôÔ∏è Replace with your backend endpoint
        const response = await fetch("/submit-form-endpoint", {
            method: "POST",
            body: formData,
        });

        if (response.ok) {
            message.textContent = "‚úÖ Thank you! Your form was submitted successfully.";
            form.reset();
            fileList.innerHTML = "";
        } else {
            message.textContent = "‚ö†Ô∏è There was an issue submitting the form. Please try again.";
        }
        } catch (error) {
        console.error(error);
        message.textContent = "‚ùå Network error. Please check your connection.";
        }
    });
    });
</script>


<BaseLayout
  title="Contact"
  description="High-quality in-house embroidery, screen printing, and custom apparel decoration in Edmonton. Serving businesses across Alberta and North America with fast, reliable, and professional service."
  preloadedImage = {optimizedImage}
>
  <!-- ============================================ -->
  <!--                    LANDING                   -->
  <!-- ============================================ -->

  <Landing 
    title="Contact"
    image={optimizedImage}
  />

  <!-- ============================================ -->
  <!--                   Contact                    -->
  <!-- ============================================ -->

  <section id="contact">
    <div class="container">
        <div class="left">
            <div class="upper">
                <h3 class="cs-title">Get a Free Quote</h3>
                <p class="cs-text">Fill out our quick form to get a personalized quote.</p>
            </div>
            <div class="lower">
                <h3 class="cs-title">Chat with our virtual assistant and get a custom quote</h3>
                <p class="cs-text">Start a conversation to get a custom quote instantly.</p>
                <!-- <a class="chat-button" href="#">Start Chat</a> -->
            </div>
        </div>
        <div class="right">
            <h3 class="cs-title">Minimum Order 24  Pieces</h3>
            <div class="form-wrapper">
                <form id="contactForm" action="" method="POST" enctype="multipart/form-data" data-netlify="true">
                    <div class="form-group">
                        <label>Name <span class="required">*</span></label>
                        <div class="row">
                        <input type="text" name="name" placeholder="First Name" required>
                        <input type="text" name="lastname" placeholder="Last Name" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Email <span class="required">*</span></label>
                        <input type="email" name="email" placeholder="Your Email" required>
                    </div>

                    <div class="form-group">
                        <label>Phone Number <span class="required">*</span></label>
                        <input type="tel" name="phone" placeholder="(000) 000-0000" required>
                        <small>Please enter a valid phone number.</small>
                    </div>

                    <div class="form-group">
                        <label>Company Name</label>
                        <input type="text" name="company" placeholder="Optional">
                        <small>Or tell us if it‚Äôs personal!</small>
                    </div>

                    <div class="form-group">
                        <label>Contact Method <span class="required">*</span></label>
                        <select name="contactMethod" required>
                        <option value="" disabled selected>Please Select</option>
                        <option value="call">Call me</option>
                        <option value="text">Text me</option>
                        <option value="email">Email me</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Message <span class="required">*</span></label>
                        <textarea name="message" placeholder="Your Message" required></textarea>
                    </div>

                    <div class="form-group">
                        <label>File Upload</label>
                        <div class="file-upload">
                        <input id="fileInput" type="file" name="file[]" multiple
                            accept=".png,.jpeg,.jpg,.webp,.tif,.tiff,.pdf,.doc,.docx,.ai,.eps,.svg,.idml,.sketch">
                        <div class="upload-box" id="uploadBox">
                            <div class="upload-icon">üìÅ</div>
                            <strong>Share Art and Project Files</strong>
                            <p>Drag and drop files here, or click to browse</p>
                        </div>
                        </div>
                        <div id="fileList"></div>
                    </div>

                    <button type="submit" id="submitBtn">Submit</button>
                    <p id="formMessage" style="display:none;"></p>
                </form>

            </div>
        </div>
    </div>
  </section>
                                
</BaseLayout>



<style lang="less">
  /* PAGE-SPECIFIC STYLES FOR THE CONTACT PAGE */

/*-- -------------------------- -->
<---          Contact           -->
<--- -------------------------- -*/

/* Mobile - 360px */
@media only screen and (min-width: 0rem) {
    #contact{
        .container{
            margin: 8px auto;
            display: flex;
            flex-direction: column;
            gap: 32px;
            .left{
                width: 100%;
                display: flex;
                flex-direction: column;
                justify-content: stretch;
                font-family: inherit;
                box-sizing: border-box;

                

                .cs-title{
                    font-size: 20px;
                    color: #fff;
                }
                .cs-text{
                    font-size: 15px;
                    color: #fff;
                }
                .upper{
                    background-color: var(--primary);
                    padding: 32px 16px;
                    min-height: auto;
                    .cs-title{
                        color: #fff;
                    }
                    .cs-text{
                        color: #fff;
                    }
                }
                .lower{
                    padding: 32px 16px;
                    min-height: auto;
                    background-color: hsl(240, 90%, 55%);
                    .chat-button{
                        width: 100%;
                        text-align: center;
                        font-size: 14px;
                        padding: 10px 20px;
                        display: inline-block;
                        margin-top: 32px;
                        font-weight: 600;
                        color: #fff;
                        background-color: transparent;
                        border: 1px solid #fff;
                        text-decoration: none;
                        box-shadow: none;
                        transition: all 0.25s ease;
                        &:hover{
                            border: none;
                            background: var(--primary);
                            color: #fff;
                        }
                    }
                    
                }
            }
            .right{
                .cs-title{
                    width: 100%;
                    color: var(--primary);
                }
                .form-wrapper{
                    padding: 30px 20px;

                    max-width: 720px;
                    margin: 20px auto;
                    background: white;
                    box-sizing: border-box;
                    font-family: inherit;

                    form{
                        display: flex;
                        flex-direction: column;
                        gap: 25px;
                        font-family: inherit;
                        input, select, textarea{
                            padding: 14px;
                            font-size: 16px;
                            border: 1px solid #ccc;
                            border-radius: 6px;
                            width: 100%;
                            box-sizing: border-box;
                            font-family: inherit;
                        }
                        select{
                            background-color: #fff;
                            appearance: none;
                        }
                        textarea{
                            height: 26px;
                            resize: vertical;
                            min-height: 120px;
                        }

                        #submitBtn{
                            background-color: var(--primary);
                            color: white;
                            border: none;
                            padding: 16px;
                            font-size: 16px;
                            border-radius: 6px;
                            cursor: pointer;
                            transition: background 0.3s ease;
                            font-family: inherit;
                            &:hover{
                                background-color: var(--primaryLight);
                                color: #000;
                            }
                        }
                    }

                    .form-group{
                        label{
                            font-weight: 500;
                            margin-bottom: 6px;
                            display: block;
                            font-family: inherit;
                        }
                        .row{
                            display: flex;
                            flex-direction: column;
                            gap: 20px;
                            flex-wrap: wrap;

                            input{
                                flex: 1;
                                min-width: 120px;
                                font-family: inherit;

                                padding: 14px;
                                font-size: 16px;
                                border: 1px solid #ccc;
                                border-radius: 6px;
                                width: 100%;
                                box-sizing: border-box;
                            }
                        }
                        .file-upload{
                            border: 1px dashed #ccc;
                            border-radius: 6px;
                            overflow: hidden;
                            padding: 0;
                            font-family: inherit;
                            input{
                                display: none;
                            }
                            .upload-box{
                                padding: 30px;
                                text-align: center;
                                cursor: pointer;
                                font-family: inherit;
                                .upload-icon{
                                    font-size: 24px;
                                    margin-bottom: 10px;
                                    font-family: inherit;
                                }
                                strong{
                                    display: block;
                                    font-size: 16px;
                                    color: #334;
                                    font-family: inherit;
                                }
                                p{
                                    font-size: 14px;
                                    color: #666;
                                    font-family: inherit;
                                }
                            }
                        }

                        .file-upload {
                            position: relative;
                            border: 2px dashed #ccc;
                            border-radius: 6px;
                            transition: border-color 0.3s ease, background-color 0.3s ease;

                            input[type="file"] {
                                display: none;
                            }

                            .upload-box {
                                padding: 30px;
                                text-align: center;
                                cursor: pointer;

                                .upload-icon {
                                font-size: 24px;
                                margin-bottom: 10px;
                                }

                                strong {
                                display: block;
                                font-size: 16px;
                                color: #334;
                                }

                                p {
                                font-size: 14px;
                                color: #666;
                                }
                            }

                            &.dragover {
                                border-color: var(--primary);
                                background-color: #f0f8ff;
                            }
                            }

                            #fileList {
                            margin-top: 10px;
                            font-size: 0.9em;

                            ul {
                                margin: 8px 0 0;
                                padding: 0;
                                list-style: none;

                                li {
                                margin-bottom: 4px;
                                color: #333;
                                }
                            }
                        }

                    }
                }
            }
        }
    }
}

/* Tablet - 768px */
@media only screen and (min-width: 48rem) {
    #contact{
        .container{
            margin: 16px auto;
            .left{
                .lower{
                    .chat-button{
                        width: auto;
                    }
                }
            }
            .right{
                .row{
                    flex-direction: row !important;
                }
            }
        }
    }
}

/* Desktop - 1024px */
@media only screen and (min-width: 64rem) {
    #contact{
        .container{
            margin: 24px auto;
            flex-direction: row;
            .left{
                width: 50%;
                border: none;
                .upper{
                    padding: 60px 40px;
                    min-height: 65vh;
                    padding-top: 400px;
                }
                .lower{
                    padding: 60px 40px;
                    height: 100%;
                    min-height: 65vh;
                }
            }
            .right{

            }
        }
    }
}

/* Large Desktop - 1300px */
@media only screen and (min-width: 81.25rem) {
    #contact{
        .container{
            .left{
                .upper{
                    
                }
            }
        }

    }
}

/* Largest Desktop - 1920px */
@media only screen and (min-width: 120rem) {

}

// /* Dark Mode */
// @media only screen and (min-width: 0rem) {
//     body.dark-mode {
//         #contact{
//             .chat-button{
//                 color: #fff !important;
//                 border: 1px solid #fff !important;
//             }
//         }
//     }
// }
                                
</style>
